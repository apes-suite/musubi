<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A multi-level parallel lattice Boltzmann solver within the APES suite.">
    <meta name="author" content="University of Siegen" >
    <link rel="icon" href="../favicon.png">

    <title>mus_physics_module &ndash; Musubi</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Musubi </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">Documentation</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>mus_physics_module
      <small>Module</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-author"><i class="fa fa-pencil"></i> Kannan Masilamani</li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.7% of total for modules and submodules.">400 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mus_physics_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mus_physics_module.f90.html'>mus_physics_module.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">mus_physics_module</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3">
        <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/mus_physics_module.html#variable-coulomb_ref">coulomb_ref</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#variable-mole_ref">mole_ref</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#variable-k_b">k_b</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#variable-faraday">faraday</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#variable-gasconst_r">gasConst_R</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#types-0"
         aria-expanded="false" aria-controls="types-0">
         <h4 class="card-header bg-primary text-white">Derived Types</h4>
      </a>
      <div id="types-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/mus_physics_module.html#type-mus_convertfac_type">mus_convertFac_type</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#type-mus_physics_type">mus_physics_type</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#funcs-0"
         aria-expanded="false" aria-controls="funcs-0">
         <h4 class="card-header bg-primary text-white">Functions</h4>
      </a>
      <div id="funcs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/mus_physics_module.html#proc-set_values_by_levels">set_values_by_levels</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/mus_physics_module.html#proc-mus_load_physics">mus_load_physics</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#proc-mus_set_convfac">mus_set_convFac</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#proc-mus_create_funcstr">mus_create_funcStr</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#proc-mus_physics_out">mus_physics_out</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#proc-mus_physics_out_conv">mus_physics_out_conv</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#proc-mus_physics_dump2outunit">mus_physics_dump2outUnit</a>
            <a class="list-group-item" href="../module/mus_physics_module.html#proc-mus_set_scalefac">mus_set_scaleFac</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  


  </div>

    </div>

    <div class="col-md-9" id='text'>
      <p>This module contains data type and modules related to musubi
 lattice to physical unit convertion and vice versa.
 physics data type is global for all schemes, it is defined
 in the following format:</p>
<div class="codehilite"><pre><span></span><code> <span class="n">physics</span> <span class="o">=</span> <span class="p">{</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">dt_phy</span><span class="p">,</span> <span class="c1">-- physical time step size</span>
             <span class="n">rho0</span> <span class="o">=</span> <span class="n">rho0_phy</span><span class="p">,</span> <span class="c1">-- reference density</span>
             <span class="n">temp0</span> <span class="o">=</span> <span class="n">t_phy</span> <span class="c1">-- reference temperature</span>
<span class="p">}</span>
</code></pre></div>

<p>Of these quantities, dt is mandetory for conversion.
 Others can be omitted, thus use default values.</p>
<p>To add a new conversion factor, one has to do the following:</p>
<ol>
<li>add this new factor into [mus_convertFac_type]</li>
<li>add the defination of factor inside routine [mus_set_convFac]</li>
<li>add this new factor into routine [mus_physics_out]</li>
</ol>
<br>          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_aux_module.html'>tem_aux_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/aotus/module/aot_table_module.html'>aot_table_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/aotus/module/aot_out_module.html'>aot_out_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_geometry_module.html'>tem_geometry_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/treelmesh_module.html'>treelmesh_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_tools_module.html'>tem_tools_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_logging_module.html'>tem_logging_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/aotus/module/aotus_module.html'>aotus_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_param_module.html'>tem_param_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/env_module.html'>env_module</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>

      
      <br>


        <section>
          <h2>Variables</h2>
            <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-coulomb_ref"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>coulomb_ref</strong></td>
<td> =</td>
                <td>1.60217657e-19_rk</td>
            <td>
                <p>Reference coulomb is set to fundamental electrical charge</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mole_ref"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>mole_ref</strong></td>
<td> =</td>
                <td>1e-23_rk/6.02214129</td>
            <td>
                <p>Reference mole is set to inverse of Avogadro's constant</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_b"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>k_b</strong></td>
<td> =</td>
                <td>1.38064852e-23_rk</td>
            <td>
                <p>the boltzmann constant J K^-1</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-faraday"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>faraday</strong></td>
<td> =</td>
                <td>96485.3365_rk</td>
            <td>
                <p>Faraday constant C/mol</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gasconst_r"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>gasConst_R</strong></td>
<td> =</td>
                <td>8.3144621_rk</td>
            <td>
                <p>Ideal gas constant N m / (mol K)</p>
            </td>
        </tr>
    </tbody>
  </table>

        </section>
        <br>




        <section>
          <h2>Derived Types</h2>
              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-mus_convertfac_type"></span>
      <h3>
        type, public&nbsp;::&nbsp;
        <a href='../type/mus_convertfac_type.html'>mus_convertFac_type</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>This type contains the converstion factor for derived variables
from lattice to physical.</p><a href="../type/mus_convertfac_type.html" class="pull-right"><emph>Read more&hellip;</emph></a>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-length"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>length</strong></td>
                <td></td>
                <td></td>
            <td>
<p>length (m) = dx</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time</strong></td>
                <td></td>
                <td></td>
            <td>
<p>time (s) = dt</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vel"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>vel</strong></td>
                <td></td>
                <td></td>
            <td>
<p>velocity(m/s) = dx/dt</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-visc"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>visc</strong></td>
                <td></td>
                <td></td>
            <td>
<p>kinematic viscosity(m^2/s) = dx^2/dt</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-viscdyna"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>viscDyna</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Dynamic viscosity (Pa s) = kg/m/s</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-accel"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>accel</strong></td>
                <td></td>
                <td></td>
            <td>
<p>acceleration(m/s^2) = dx/dt^2</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-force"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>force</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Force(N)(kg m/s^2) = rho0*dx^4/dt^2</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-body_force"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>body_force</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Force per unit volume (N/m^3)(kg/s^2/m^2) = rho0*dx/dt^2</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-press"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>press</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Pressure(N/m^2)(kg/m/s^2) = rho0*dx^2/dt^2</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-strainrate"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>strainRate</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Strain Rate (1/s) = 1/dt</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-energy"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>energy</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Energy (N-m) (kg<em>m^2/s^2) = rho0</em>dx^5/dt^2</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-chargedens"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>chargeDens</strong></td>
                <td></td>
                <td></td>
            <td>
<p>mole density(mol/m^3) = mole0/dx^3
Charge density (C/m^3) = Coulomb0/dx^3</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-currentdens"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>currentDens</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Current density (C/s/m^2) = Coulomb0/dt/dx^2</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-moleflux"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>moleFlux</strong></td>
                <td></td>
                <td></td>
            <td>
<p>mole flux(mol/m^2/s) = moleDen0*dx/dt</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-flux"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>flux</strong></td>
                <td></td>
                <td></td>
            <td>
<p>mass flux(kg/m^2/s) = rho0*dx/dt</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-diffusivity"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>diffusivity</strong></td>
                <td></td>
                <td></td>
            <td>
<p>diffusivity(m^2/s) = dx^2/dt</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-faraday~2"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>faraday</strong></td>
                <td></td>
                <td></td>
            <td>
<p>faraday (C/mol) = coulomb0/moleDens0/dx^3</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-gasconst"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>gasConst</strong></td>
                <td></td>
                <td></td>
            <td>
<p>gas constant (J/mol/K) (N m/mol/K) (kg m^2/s^2/mol/K)
= rho0*dx^5/dt^2/mole0/temp0</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-potential"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>potential</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Potential (V) (kg m^2/(C*S^2))</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sourcecoeff"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>sourceCoeff</strong></td>
                <td></td>
                <td></td>
            <td>
<p>sourceCoeff (1/s) = 1/dt</p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-mus_physics_type"></span>
      <h3>
        type, public&nbsp;::&nbsp;
        <a href='../type/mus_physics_type.html'>mus_physics_type</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>This type contains the reference values as defined in the physics
table by the user</p><a href="../type/mus_physics_type.html" class="pull-right"><emph>Read more&hellip;</emph></a>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-active"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>active</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>needed to check if physics table is defined</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dx~3"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dx</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>reference length - discretization size of the coarsest level
SI unit - meter</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dxlvl"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dxLvl</strong>(:)</td>
                <td></td>
                <td></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dt~3"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dt</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>reference time - time discretization for discretization size
of the coarsest level
SI unit - seconds</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dtlvl"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dtLvl</strong>(:)</td>
                <td></td>
                <td></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rho0"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rho0</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>reference physical mass density
SI unit - kg/m^3</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-moledens0"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>moleDens0</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>reference physical mole density
SI unit - mol/m^3</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-molweight0"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>molWeight0</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>reference molecular weight
SI unit - kg/mol</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-temp0"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>temp0</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>reference temperature
SI unit - Kelvin</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-coulomb0"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>coulomb0</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>reference fundamental electrical charge
SI unit - Coulomb</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mole0"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mole0</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>mole is defined by inverse of Avogadro Constant
Avogadro Constant = 6.02214129e23 [1/mol]</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-mass0"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>mass0</strong></td>
<td> =</td>
                <td>-1.0_rk</td>
            <td>
<p>reference mass in kg derived from density or moleweight
SI unit :: kg</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fac"></span>
              type(<a href='../type/mus_convertfac_type.html'>mus_convertFac_type</a>),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>fac</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>Level-wise conversion factor for derived variables
size: minLevel:maxLevel
allocated in mus_load_physics
\todo KM: conversion factor should not be level-dependent.
it should be same for all levels, the lattice dx and dt for each level
must be considered to scale variables in multilevel.
Implemented force, visc, etc using dtL according to formula
Introduced lattice speed variable: dx/dt for each level
it should be same for all level for acoustic scaling and different
for diffusive scaling</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pfac"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>pFac</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
<p>Pressure (strain rate) over level scale factor.
This factor is meant to convert pressure in LB unit on source level to
the required pressure on target level.
It is mainly used in interpolation routine.
It is allocated as: allocate(pFac( minLevel:maxLevel, minLevel:maxLevel))
It is allocated and initialized in routine: mus_set_scaleFac
How to use it in the code:
pTargetLevel = pSourceLevel * pFac( sourceLevel, targetLevel )</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vfac"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>vFac</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
<p>Velocity over level scale factor
Its usage is the same as pressure scale factor</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sfac"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>sFac</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
<p>Strain rate over level scale factor
Its usage is the same as pressure scale factor</p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

        </section>
        <br>

        <section>
          <h2>Functions</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_values_by_levels"></span> <h3>public pure function <a href='../proc/set_values_by_levels.html'>set_values_by_levels</a>(valMinLevel, minLevel, maxLevel, scaleFac) result(values)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-valminlevel"></span>
              real(kind=rk),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>valMinLevel</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minlevel~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>minLevel</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxlevel~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxLevel</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scalefac"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>scaleFac</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=rk), (minLevel:maxLevel)</small>
    </h4>
    

    </div>
  </div>

        </section>
        <br>

        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_load_physics"></span> <h3>public  subroutine <a href='../proc/mus_load_physics.html'>mus_load_physics</a>(me, conf, tree, scaleFactor)  
</h3></div>
    <div class="card-body">
          
  <p>This routine loads the physics table from musubi config file</p><a href="../proc/mus_load_physics.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me"></span>
              type(<a href='../type/mus_physics_type.html'>mus_physics_type</a>),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>
<p>physics type</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-conf"></span>
              type(<a href='https://apes-suite.github.io/aotus/type/flu_state.html'>flu_State</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>conf</strong></td>
            <td>
<p>flu state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tree"></span>
              type(<a href='https://apes-suite.github.io/treelm/type/treelmesh_type.html'>treelmesh_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>tree</strong></td>
            <td>
<p>global treelm mesh</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scalefactor"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>scaleFactor</strong></td>
            <td>
<p>scaling factor: diffusive -&gt; 4; acoustic -&gt; 2</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_convfac"></span> <h3>public  subroutine <a href='../proc/mus_set_convfac.html'>mus_set_convFac</a>(me, minLevel, maxLevel)  
</h3></div>
    <div class="card-body">
          
  <p>This routine computed conversion factors for lattice to physical units.
inverse of this factors can be used to convert from physical to lattice
units.\n
use reference density to parmeterize kg and reference mole density
to parmeterize mol.\n
Multiply these factors with the LB quantity to get the physical quantity
Divide the physical quantity by these factors to get the LB units.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~2"></span>
              type(<a href='../type/mus_physics_type.html'>mus_physics_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minlevel"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>minLevel</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxlevel"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxLevel</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_create_funcstr"></span> <h3>public  subroutine <a href='../proc/mus_create_funcstr.html'>mus_create_funcStr</a>(fun_str)  
</h3></div>
    <div class="card-body">
          
  <p>This routine creates musubi specific lua function to compute dx and dt.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-fun_str"></span>
              character(len=*)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fun_str</strong></td>
            <td>
<p>This string contains lua functions to compute dt from visocosity or
velocity</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_physics_out"></span> <h3>public  subroutine <a href='../proc/mus_physics_out.html'>mus_physics_out</a>(me, conf)  
</h3></div>
    <div class="card-body">
          
  <p>This routine write reference physics parameters into solver specific
string in lua format.</p><a href="../proc/mus_physics_out.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~3"></span>
              type(<a href='../type/mus_physics_type.html'>mus_physics_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-conf~2"></span>
              type(<a href='https://apes-suite.github.io/aotus/type/aot_out_type.html'>aot_out_type</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>conf</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_physics_out_conv"></span> <h3>public  subroutine <a href='../proc/mus_physics_out_conv.html'>mus_physics_out_conv</a>(me, conf, minLevel, maxLevel)  
</h3></div>
    <div class="card-body">
          
  <p>This routine write physics convert factor into solver specific string in
lua format.
use reference density to parmeterize kg and reference mole density
to parmeterize mol.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~4"></span>
              type(<a href='../type/mus_physics_type.html'>mus_physics_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-conf~3"></span>
              type(<a href='https://apes-suite.github.io/aotus/type/aot_out_type.html'>aot_out_type</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>conf</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minlevel~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>minLevel</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxlevel~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxLevel</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_physics_dump2outunit"></span> <h3>public  subroutine <a href='../proc/mus_physics_dump2outunit.html'>mus_physics_dump2outUnit</a>(me, outUnit, minLevel, maxLevel)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~5"></span>
              type(<a href='../type/mus_physics_type.html'>mus_physics_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-outunit"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>outUnit</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minlevel~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>minLevel</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxlevel~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxLevel</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_scalefac"></span> <h3>public  subroutine <a href='../proc/mus_set_scalefac.html'>mus_set_scaleFac</a>(me, minLevel, maxLevel)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~6"></span>
              type(<a href='../type/mus_physics_type.html'>mus_physics_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minlevel~5"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>minLevel</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxlevel~5"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxLevel</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

        </section>
        <br>



    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Musubi
 was developed by University of Siegen<br>              &copy; 2025 
<br /><small>2b7f395fde2e</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-12-01T15:24:44.393117+0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>