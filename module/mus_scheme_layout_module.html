<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A multi-level parallel lattice Boltzmann solver within the APES suite.">
    <meta name="author" content="University of Siegen" >
    <link rel="icon" href="../favicon.png">

    <title>mus_scheme_layout_module &ndash; Musubi</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Musubi </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">Documentation</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>mus_scheme_layout_module
      <small>Module</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-author"><i class="fa fa-pencil"></i> Simon Zimny</li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.7% of total for modules and submodules.">393 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/mus_scheme_layout_module.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mus_scheme_layout_module.f90.html'>mus_scheme_layout_module.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">mus_scheme_layout_module</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#types-0"
         aria-expanded="false" aria-controls="types-0">
         <h4 class="card-header bg-primary text-white">Derived Types</h4>
      </a>
      <div id="types-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#type-mus_scheme_layout_type">mus_scheme_layout_type</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#funcs-0"
         aria-expanded="false" aria-controls="funcs-0">
         <h4 class="card-header bg-primary text-white">Functions</h4>
      </a>
      <div id="funcs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_calculate_speed_of_sound">mus_calculate_speed_of_sound</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_load_newlayout">mus_load_newLayout</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_weights_out">mus_weights_out</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_init_layout">mus_init_layout</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_finalize_layout">mus_finalize_layout</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_destroy_stencil">mus_destroy_stencil</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_layout">mus_define_layout</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_d3q19">mus_define_d3q19</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_set_weights_d3q19">mus_set_weights_d3q19</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_d3q27">mus_define_d3q27</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_set_weights_d3q27">mus_set_weights_d3q27</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_d3q7">mus_define_d3q7</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_set_weights_d3q7">mus_set_weights_d3q7</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_d3q6">mus_define_d3q6</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_set_weights_d3q6">mus_set_weights_d3q6</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_d2q9">mus_define_d2q9</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_set_weights_d2q9">mus_set_weights_d2q9</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_d1q3">mus_define_d1q3</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_set_weights_d1q3">mus_set_weights_d1q3</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_d3q13">mus_define_d3q13</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_set_weights_d3q13">mus_set_weights_d3q13</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_define_d2q5">mus_define_d2q5</a>
            <a class="list-group-item" href="../module/mus_scheme_layout_module.html#proc-mus_set_weights_d2q5">mus_set_weights_d2q5</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  


  </div>

    </div>

    <div class="col-md-9" id='text'>
      <p>scheme_layout module, providing the scheme_layout datatype and the
 functionality to read the lua files and to set the predefined stencils.</p>
<p># Scheme Layout</p>
<p>The layout includes all information about the stencil, the inverse
 directions, the prevailing directions and the weights.</p>
<p>In MUSUBI one can choose among the following predefined layouts:</p>
<ul>
<li>'predefined_d3q19':
    The D3Q19 model. The advection relaxation kernel for this model is highly
    optimized.</li>
<li>'predefined_d3q7':
    The more simple D3Q7 model. The advection relaxation kernel for this
    model is highly optimized.</li>
<li>'Flekkoy':
    The Flekkoy model consists of a D3Q6 stencil and is used for passive
    scalar transport.</li>
</ul>
<p>In MUSUBI it is also possible to define a new layout in the lua file. This
 feature is implemented to test new layouts. In case one wants to run
 multiple simulations using this layout, it is highly recommended to
 implement a new kernel (the following files have to be extended:
 <a href="../module/mus_flow_module.html">mus_flow_module</a> and related modules in source/compute.</p>
<p>Defining a new Layout
 To define a new layout one has to set <code>layout = 'new_stencil'</code>. To define the
 stencil the following information has to be provided:</p>
<ul>
<li>the number of offsets (QQ)</li>
<li>the offsets (disc_vel)</li>
<li>the weights (weight)</li>
<li>the inverse directions (inv_dir) as integers pointing on the belonging
     offsets</li>
<li>the prevailing directions (prev_dir) as reals giving the distance in the
     different directions</li>
</ul>
<p>The following example shows how to define the standard D3Q19 as a new
 layout:</p>
<div class="codehilite"><pre><span></span><code> <span class="c1">-- Scheme</span>
 <span class="n">scheme</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span>
  <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;new_stencil&#39;</span><span class="p">,</span>
  <span class="c1">-- Initial condition</span>
  <span class="n">initial_condition</span> <span class="o">=</span> <span class="p">{</span>
                       <span class="n">density</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                       <span class="n">velocityX</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
                       <span class="n">velocityY</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
                       <span class="n">velocityZ</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="p">},</span>
  <span class="c1">-- Boundary conditions</span>
  <span class="n">boundary_condition</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;wall&#39;</span><span class="p">,</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;velocity_bounceback&#39;</span><span class="p">,</span>
    <span class="n">velocityX</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">velocityY</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">velocityZ</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="p">},</span>
  <span class="p">{</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;wall&#39;</span><span class="p">,</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;wall&#39;</span><span class="p">,</span>
    <span class="n">velocityX</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">velocityY</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">velocityZ</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="n">fluid</span> <span class="o">=</span> <span class="p">{</span> <span class="n">relaxation_scheme</span> <span class="o">=</span> <span class="s1">&#39;BGK&#39;</span><span class="p">,</span>
            <span class="n">omega</span> <span class="o">=</span> <span class="mf">1.8</span><span class="p">,</span>
            <span class="n">rho0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">},</span>
  <span class="c1">-- Defining the new Stencil</span>
  <span class="n">stencil</span> <span class="o">=</span> <span class="p">{</span>
             <span class="n">QQ</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
             <span class="n">disc_vel</span> <span class="o">=</span> <span class="p">{</span>
              <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">},{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span>
              <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">},{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">},{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">},{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span>
              <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">}</span>
             <span class="p">},</span>
             <span class="n">weight</span> <span class="o">=</span> <span class="p">{</span>
              <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">18.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">18.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">18.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">18.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">18.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">18.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),</span>
              <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">36.0</span><span class="p">),</span>
              <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>
             <span class="p">},</span>
             <span class="n">inv_dir</span> <span class="o">=</span> <span class="p">{</span>
                         <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>
                         <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
                        <span class="mi">19</span>
             <span class="p">},</span>
             <span class="n">prev_dir</span> <span class="o">=</span> <span class="p">{</span>
              <span class="p">{</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">},{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">},{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">},{</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">},{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">},{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">},</span>
              <span class="p">{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)},{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)},</span>
              <span class="p">{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)},{</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)},</span>
              <span class="p">{</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)},{</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)},</span>
              <span class="p">{</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)},{</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)},</span>
              <span class="p">{</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.</span><span class="p">},{</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.</span><span class="p">},</span>
              <span class="p">{</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.</span><span class="p">},{</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">math.sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mf">0.</span><span class="p">}</span>
             <span class="p">}</span>
  <span class="p">}</span>
 <span class="p">}</span>
</code></pre></div>
<br>          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='mus_scheme_derived_quantities_module.html'>mus_scheme_derived_quantities_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_param_module.html'>tem_param_module</a></li>
                  <li class="list-inline-item"><a href='http://www.mpi-forum.org/docs/mpi-3.1/mpi31-report/node410.htm'>mpi</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_tools_module.html'>tem_tools_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/aotus/module/aotus_module.html'>aotus_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_logging_module.html'>tem_logging_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_stencil_module.html'>tem_stencil_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/aotus/module/aot_table_module.html'>aot_table_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_grow_array_module.html'>tem_grow_array_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/aotus/module/aot_out_module.html'>aot_out_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_comm_env_module.html'>tem_comm_env_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/env_module.html'>env_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_dyn_array_module.html'>tem_dyn_array_module</a></li>
                  <li class="list-inline-item"><a href='mus_moments_type_module.html'>mus_moments_type_module</a></li>
                  <li class="list-inline-item"><a href='https://apes-suite.github.io/treelm/module/tem_aux_module.html'>tem_aux_module</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>

      
      <br>






        <section>
          <h2>Derived Types</h2>
              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-mus_scheme_layout_type"></span>
      <h3>
        type, public&nbsp;::&nbsp;
        <a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>data structure containing all information related to the
compute stencil. Several stencils can be defined.
<a href="../module/mus_moments_module.html">mus_moments_module</a> Moments are directly related to the
stencil layout and are therefore defined here</p>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-fstencil"></span>
              type(<a href='https://apes-suite.github.io/treelm/type/tem_stencilheader_type.html'>tem_stencilHeader_type</a>),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fStencil</strong></td>
                <td></td>
                <td></td>
            <td>
<p>fluid stencil same as stencil(1)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nstencils~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nStencils</strong></td>
                <td></td>
                <td></td>
            <td>
<p>number of stencils used in this scheme</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-grwstencil~3"></span>
              type(<a href='https://apes-suite.github.io/treelm/type/grw_stencilheaderarray_type.html'>grw_stencilheaderarray_type</a>),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>grwStencil</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Temporary growing array of stencil
It is copied to stencil(:) and destroyed, where this is destroyed?</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-stencil~86"></span>
              type(<a href='https://apes-suite.github.io/treelm/type/tem_stencilheader_type.html'>tem_stencilHeader_type</a>),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>stencil</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>The list of stencil types, the stencils for the individual schemes
is ordered as follows:</p><a href="../type/mus_scheme_layout_type.html#variable-stencil~86" class="pull-right"><emph>Read more&hellip;</emph></a>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-stencil_labels~2"></span>
              type(<a href='https://apes-suite.github.io/treelm/type/dyn_labelarray_type.html'>dyn_labelarray_type</a>),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>stencil_labels</strong></td>
                <td></td>
                <td></td>
            <td>
<p>dynamic array of labels created from stencil directions to create unique
growing array of grwStencil</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fstencil_pos"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fStencil_pos</strong></td>
                <td></td>
                <td></td>
            <td>
<p>position of fluid stencil in grwStencil</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-weight~32"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>weight</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>The weights for the different discrete velocities</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-cs"></span>
              real(kind=rk),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cs</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Lattice speed of sound for fStencil
$\sum_i (weight_i<em>cx_i</em>cx_i) = c_s^2 I</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-prevaildir~2"></span>
              real(kind=rk),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>prevailDir</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
<p>Prevailing directions</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-moment"></span>
              type(<a href='../type/mus_moment_type.html'>mus_moment_type</a>),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>moment</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Moment space definition</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-new_stencil"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>new_stencil</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>New stencil definition loaded from config</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-quantities~20"></span>
              type(<a href='../type/mus_scheme_derived_quantities_type.html'>mus_scheme_derived_quantities_type</a>),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>quantities</strong></td>
                <td></td>
                <td></td>
            <td>
<p>derive quantities that depends on the layout such as velocity, pdf_eq, etc..</p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

        </section>
        <br>

        <section>
          <h2>Functions</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_calculate_speed_of_sound"></span> <h3>private  function <a href='../proc/mus_calculate_speed_of_sound.html'>mus_calculate_speed_of_sound</a>(layout) result(c_sound)  
</h3></div>
    <div class="card-body">
          
  <p>Calculate lattice speed of sound for given stencil</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~211"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=rk)</small>
    </h4>
    

    </div>
  </div>

        </section>
        <br>

        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_load_newlayout"></span> <h3>public  subroutine <a href='../proc/mus_load_newlayout.html'>mus_load_newLayout</a>(me, parent_handle, conf)  
</h3></div>
    <div class="card-body">
          
  <p>load a new stencil definition from the lua file</p><a href="../proc/mus_load_newlayout.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~201"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parent_handle"></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>parent_handle</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-conf~73"></span>
              type(<a href='https://apes-suite.github.io/aotus/type/flu_state.html'>flu_State</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>conf</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_weights_out"></span> <h3>public  subroutine <a href='../proc/mus_weights_out.html'>mus_weights_out</a>(me, conf)  
</h3></div>
    <div class="card-body">
          
  <p>Dump the weights in lua format.</p><a href="../proc/mus_weights_out.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~202"></span>
              real(kind=rk),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong>(:)</td>
            <td>
<p>weights</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-conf~74"></span>
              type(<a href='https://apes-suite.github.io/aotus/type/aot_out_type.html'>aot_out_type</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>conf</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_init_layout"></span> <h3>public  subroutine <a href='../proc/mus_init_layout.html'>mus_init_layout</a>(layout)  
</h3></div>
    <div class="card-body">
          
  <p>Initialize growing array of stencils</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~200"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>musubi schemes layout type</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_finalize_layout"></span> <h3>public  subroutine <a href='../proc/mus_finalize_layout.html'>mus_finalize_layout</a>(layout, nElemsInTree, minLevel, maxLevel, proc)  
</h3></div>
    <div class="card-body">
          
  <p>This routine finialize grwStencil by truncating stencil elem arrays and
set stencil%nElems</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~201"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelemsintree"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElemsInTree</strong></td>
            <td>
<p>fluid tree from mesh</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minlevel~90"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>minLevel</strong></td>
            <td>
<p>min and max level</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxlevel~88"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxLevel</strong></td>
            <td>
<p>min and max level</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-proc~31"></span>
              type(<a href='https://apes-suite.github.io/treelm/type/tem_comm_env_type.html'>tem_comm_env_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>proc</strong></td>
            <td>
<p>mpi communication type</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_destroy_stencil"></span> <h3>public  subroutine <a href='../proc/mus_destroy_stencil.html'>mus_destroy_stencil</a>(stencil)  
</h3></div>
    <div class="card-body">
          
  <p>Destroy the stencil</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-stencil~87"></span>
              type(<a href='https://apes-suite.github.io/treelm/type/tem_stencilheader_type.html'>tem_stencilHeader_type</a>),
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>stencil</strong>(:)</td>
            <td>
<p>musubi schemes stencil type</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_layout"></span> <h3>public  subroutine <a href='../proc/mus_define_layout.html'>mus_define_layout</a>(layout, stencilName, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This routine defines layout for predefined stencils</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~202"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-stencilname"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>stencilName</strong></td>
            <td>
<p>Name of the stencil to create</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~245"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_d3q19"></span> <h3>public  subroutine <a href='../proc/mus_define_d3q19.html'>mus_define_d3q19</a>(layout, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This subroutine sets the parameters for the predefined d3q19 stencil.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~204"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~247"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_weights_d3q19"></span> <h3>public  subroutine <a href='../proc/mus_set_weights_d3q19.html'>mus_set_weights_d3q19</a>(weights)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-weights~19"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>weights</strong>(19)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_d3q27"></span> <h3>public  subroutine <a href='../proc/mus_define_d3q27.html'>mus_define_d3q27</a>(layout, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This subroutine sets the parameters for the predefined d3q27 stencil.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~205"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~248"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_weights_d3q27"></span> <h3>public  subroutine <a href='../proc/mus_set_weights_d3q27.html'>mus_set_weights_d3q27</a>(weights)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-weights~20"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>weights</strong>(27)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_d3q7"></span> <h3>public  subroutine <a href='../proc/mus_define_d3q7.html'>mus_define_d3q7</a>(layout, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This subroutine sets the parameters for the predefined d3q7 stencil.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~206"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~249"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_weights_d3q7"></span> <h3>public  subroutine <a href='../proc/mus_set_weights_d3q7.html'>mus_set_weights_d3q7</a>(weights)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-weights~21"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>weights</strong>(7)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_d3q6"></span> <h3>public  subroutine <a href='../proc/mus_define_d3q6.html'>mus_define_d3q6</a>(layout, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This subroutine sets the parameters for the predefined d3q6
layout%fStencil, used by the Flekkoy model of passive scalar transport.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~207"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~250"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_weights_d3q6"></span> <h3>public  subroutine <a href='../proc/mus_set_weights_d3q6.html'>mus_set_weights_d3q6</a>(weights)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-weights~22"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>weights</strong>(6)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_d2q9"></span> <h3>public  subroutine <a href='../proc/mus_define_d2q9.html'>mus_define_d2q9</a>(layout, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This subroutine sets the parameters for the predefined d2q9 stencil.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~208"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~251"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_weights_d2q9"></span> <h3>public  subroutine <a href='../proc/mus_set_weights_d2q9.html'>mus_set_weights_d2q9</a>(weights)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-weights~23"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>weights</strong>(9)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_d1q3"></span> <h3>public  subroutine <a href='../proc/mus_define_d1q3.html'>mus_define_d1q3</a>(layout, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This subroutine sets the parameters for the predefined d2q9 stencil.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~210"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~253"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_weights_d1q3"></span> <h3>public  subroutine <a href='../proc/mus_set_weights_d1q3.html'>mus_set_weights_d1q3</a>(weights)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-weights~25"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>weights</strong>(3)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_d3q13"></span> <h3>private  subroutine <a href='../proc/mus_define_d3q13.html'>mus_define_d3q13</a>(layout, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This subroutine sets the parameters for the predefined d3q13 stencil.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~203"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~246"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_weights_d3q13"></span> <h3>private  subroutine <a href='../proc/mus_set_weights_d3q13.html'>mus_set_weights_d3q13</a>(weights)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-weights~18"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>weights</strong>(13)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_define_d2q5"></span> <h3>private  subroutine <a href='../proc/mus_define_d2q5.html'>mus_define_d2q5</a>(layout, nElems)  
</h3></div>
    <div class="card-body">
          
  <p>This subroutine sets the parameters for the predefined d2q5 stencil.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-layout~209"></span>
              type(<a href='../type/mus_scheme_layout_type.html'>mus_scheme_layout_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>layout</strong></td>
            <td>
<p>scheme layout for pdf state</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nelems~252"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nElems</strong></td>
            <td>
<p>number of elements use this layout</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-mus_set_weights_d2q5"></span> <h3>private  subroutine <a href='../proc/mus_set_weights_d2q5.html'>mus_set_weights_d2q5</a>(weights)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-weights~24"></span>
              real(kind=rk)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>weights</strong>(5)</td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

        </section>
        <br>



    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Musubi
 was developed by University of Siegen<br>              &copy; 2025 
<br /><small>1b6cb53ef07f</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-11-20T19:23:27.266073+0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>